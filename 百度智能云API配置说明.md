# 百度智能云API配置说明

## 一、需要配置的API信息

为了使用客厅尺寸识别功能，您需要在项目根目录的 `.env` 文件中配置以下信息：

```env
# 百度智能云API配置
BAIDU_API_KEY=your_api_key_here
BAIDU_SECRET_KEY=your_secret_key_here
```

### 如何获取百度智能云API密钥：

1. 访问 [百度智能云控制台](https://console.bce.baidu.com/)
2. 登录您的账号
3. 进入"产品服务" -> "人工智能" -> "图像识别"
4. 创建应用或使用现有应用
5. 在应用详情中获取 `API Key` 和 `Secret Key`

## 二、关于房间尺寸识别API

**重要提示：** 目前百度智能云可能没有直接提供"识别房间尺寸"的标准API。

### 可能的解决方案：

#### 方案1：使用百度EasyDL自定义模型
- 训练一个自定义模型来识别房间边界和尺寸
- 需要准备训练数据（带标注的房间图片）
- 在EasyDL平台训练模型后，通过API调用

#### 方案2：使用其他百度图像识别API组合
- 使用场景识别API识别室内场景
- 使用物体检测API识别参考物（如门、窗户等）
- 通过图像处理技术计算尺寸比例

#### 方案3：使用第三方API或服务
- 如果百度没有合适的API，可以考虑其他服务商
- 或者实现一个简单的用户手动输入界面（已实现）

### 当前实现说明

当前代码中已经实现了API调用框架，但需要根据实际可用的API进行调整：

1. **API端点**：`src/app.py` 中的 `call_baidu_room_size_api()` 函数
2. **当前使用的API**：`/rest/2.0/image-classify/v1/room_layout`
   - 如果此API不存在，需要修改为实际可用的API
   - 或者使用其他API端点

3. **返回数据格式**：代码期望API返回包含 `length` 和 `width` 字段的JSON
   - 如果实际API返回格式不同，需要修改解析逻辑

## 三、家具数据组织

为了支持按风格和尺寸过滤沙发，建议按以下方式组织家具文件：

### 文件命名规范：

```
sofa_风格_尺寸信息.jpg
```

示例：
- `sofa_modern_2.0x0.9.jpg` - 现代风格，长2.0米，宽0.9米
- `sofa_nordic_1.8x0.8.jpg` - 北欧风格，长1.8米，宽0.8米
- `sofa_european_2.2x1.0.jpg` - 欧式风格，长2.2米，宽1.0米

### 支持的风格类型：

- `modern` - 现代风格
- `nordic` - 北欧风格
- `european` - 欧式风格
- `chinese` - 中式风格
- `industrial` - 工业风格
- `minimalist` - 简约风格

### 当前实现：

代码会从文件名中解析风格信息（`_` 分隔的第二部分），但尺寸信息需要：
1. 从文件名中解析，或
2. 创建家具元数据文件（JSON格式），或
3. 在数据库中存储

**建议**：如果家具数量较多，可以创建一个 `furniture_metadata.json` 文件来存储每个家具的详细信息。

## 四、测试步骤

1. 配置 `.env` 文件中的API密钥
2. 上传一张客厅图片
3. 系统会自动调用API识别尺寸（如果API可用）
4. 如果识别失败，可以手动输入尺寸
5. 选择沙发风格
6. 系统会根据风格和房间尺寸过滤显示合适的沙发
7. 选择沙发后，继续原有的涂画和生成流程

## 五、注意事项

1. **API调用限制**：注意百度智能云API的调用次数限制和费用
2. **错误处理**：如果API调用失败，系统会提示用户手动输入尺寸
3. **尺寸单位**：所有尺寸使用"米"作为单位
4. **精度要求**：根据实际需求调整尺寸精度（当前保留2位小数）

## 六、需要您提供的信息

为了完善实现，请提供：

1. **百度智能云API信息**：
   - 您使用的具体API端点是什么？
   - API返回的数据格式是什么？
   - 是否需要特殊的认证方式？

2. **家具数据**：
   - 您有多少种风格的沙发？
   - 每个沙发的尺寸信息在哪里存储？
   - 是否需要我帮您创建家具元数据文件？

3. **尺寸识别精度**：
   - 您对尺寸识别精度的要求是什么？
   - 如果API无法识别，手动输入是否可接受？
